<?xml version="1.0" encoding="GBK"?>
<SAIS_EAW_TL>
  <JavaScripts>
    <CRU>  
		function afterSubmit(retObject,successHint,failHint){
			if(successHint==undefined) successHint = '提交成功';
			if(failHint==undefined) failHint = '提交失败';
			if (retObject.returnCode != "0") alert(failHint);
			else{			
				var ctt = top.frames('list');
				if(ctt.frames.length == 0){
					ctt.refreshData();
				}else{
					if(ctt.frames[0].length == 0){
						ctt.frames["improverecord"].location.reload();
					}else{
						ctt.frames[1].frames["improverecord"].location.reload();
					}
				}
				newClose();
			}
		}
    </CRU> 
  </JavaScripts> 
  <PagerAction>Edit</PagerAction>
  <PageTitle>增加编辑风险整改</PageTitle>
  <QuerySQL>
    <sql>select t.risk_improve_id,t.improve_user_id,t.improve_org_id,t.improve_result,t.improve_measure,t.improve_date,e.employee_name,o.org_abbreviation from bgp_risk_improve t left outer join comm_human_employee e on t.improve_user_id = e.employee_id left outer join comm_org_information o on t.improve_org_id = o.org_id where t.bsflag = '0' and t.risk_improve_id = '$PARAM.id'</sql>
    <tableName>BGP_RISK_IMPROVE</tableName>
    <fields/>
  </QuerySQL>
  <Options/>
  <Codes/>
  <EntityFields>
    <field name="risk_improve_id" isShow="Hide">风险整改ID</field>
    <field name="improve_user_id" type="FK" defaultValue="$ENTITY.improve_user_id:$ENTITY.employee_name" selValue="/common/selectOrgHR.jsp?select=employeeid">整改人</field>
    <field name="improve_org_id" type="FK" defaultValue="$ENTITY.improve_org_id:$ENTITY.org_abbreviation" selValue="/common/selectOrgHR.jsp?select=orgid">整改单位</field>
    <field name="improve_date" type="D">整改时间</field>
    <field name="improve_measure" type="MEMO">整改措施</field>
    <field name="improve_result" type="MEMO">整改结果</field>
    <field name="relation_id" isShow="Hide" defaultValue="$PARAM.relationid" action="C">关联主键</field>  
    <field name="bsflag" isShow="Hide" defaultValue="0" action="C,U">文件状态</field>
    <field name="creator_id" isShow="Hide" defaultValue="$USER.userId" selValue="NONE" action="C">创建人</field>
    <field name="updator_id" isShow="Hide" defaultValue="$USER.userId" selValue="NONE" action="C,U">修改人</field>
    <field name="create_date" isShow="Hide" defaultValue="CURRENT_DATE_TIME" action="C">创建时间</field>
    <field name="modifi_date" isShow="Hide" defaultValue="CURRENT_DATE_TIME" action="C,U">修改时间</field>
    <field name="org_id" isShow="Hide" defaultValue="$USER.codeAffordOrgID">org_id</field>
    <field name="org_subjection_id" isShow="Hide" defaultValue="$USER.subOrgIDofAffordOrg">org_subjection_id</field>
  </EntityFields>
</SAIS_EAW_TL>
